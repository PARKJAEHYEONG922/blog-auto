"""
ë¸”ë¡œê·¸ ìë™í™” AI í”„ë¡¬í”„íŠ¸ ë° êµ¬ì¡°í™”ëœ ë°ì´í„° ìƒì„±
"""
from typing import Dict, List, Any
from src.foundation.logging import get_logger

logger = get_logger("blog_automation.ai_prompts")


class BlogContentStructure:
    """ë¸”ë¡œê·¸ ì½˜í…ì¸  êµ¬ì¡° ë¶„ì„ ë° AIìš© ë°ì´í„° ìƒì„±"""
    
    def __init__(self):
        self.content_elements = []
        self.analysis_data = {}
    
    def analyze_blog_structure(self, analyzed_blogs: List[Dict]) -> Dict:
        """ë¶„ì„ëœ ë¸”ë¡œê·¸ë“¤ì˜ êµ¬ì¡°ë¥¼ ë¶„ì„í•˜ì—¬ AIìš© ë°ì´í„° ìƒì„±"""
        try:
            structured_data = {
                "keyword": "",
                "competitor_analysis": {
                    "top_blogs": [],
                    "summary": {
                        "total_blogs": len(analyzed_blogs),
                        "avg_content_length": 0,
                        "common_tags": [],
                        "content_patterns": []
                    }
                }
            }
            
            total_length = 0
            all_tags = []
            
            for blog in analyzed_blogs:
                # ê°œë³„ ë¸”ë¡œê·¸ êµ¬ì¡° ë¶„ì„
                blog_structure = self.extract_blog_structure(blog)
                structured_data["competitor_analysis"]["top_blogs"].append(blog_structure)
                
                # í†µê³„ ê³„ì‚°ìš©
                total_length += blog.get('content_length', 0)
                all_tags.extend(blog.get('tags', []))
            
            # í‰ê·  ë° ê³µí†µ íŒ¨í„´ ê³„ì‚°
            if analyzed_blogs:
                structured_data["competitor_analysis"]["summary"]["avg_content_length"] = total_length // len(analyzed_blogs)
                
                # ê°€ì¥ ë§ì´ ì‚¬ìš©ëœ íƒœê·¸ ìƒìœ„ 5ê°œ
                from collections import Counter
                tag_counter = Counter(all_tags)
                structured_data["competitor_analysis"]["summary"]["common_tags"] = [
                    tag for tag, count in tag_counter.most_common(5)
                ]
            
            return structured_data
            
        except Exception as e:
            logger.error(f"ë¸”ë¡œê·¸ êµ¬ì¡° ë¶„ì„ ì‹¤íŒ¨: {e}")
            return {}
    
    def extract_blog_structure(self, blog: Dict) -> Dict:
        """ê°œë³„ ë¸”ë¡œê·¸ì˜ êµ¬ì¡° ì¶”ì¶œ"""
        return {
            "rank": blog.get('rank', 0),
            "title": blog.get('title', ''),
            "url": blog.get('url', ''),
            "statistics": {
                "content_length": blog.get('content_length', 0),
                "image_count": blog.get('image_count', 0),
                "gif_count": blog.get('gif_count', 0),
                "video_count": blog.get('video_count', 0),
                "tag_count": len(blog.get('tags', []))
            },
            "tags": blog.get('tags', []),
            "content_preview": blog.get('text_content', '')[:200] + "..." if blog.get('text_content', '') else ''
        }


class BlogAIPrompts:
    """ë¸”ë¡œê·¸ AI ìƒì„±ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿"""
    
    @staticmethod
    def generate_content_analysis_prompt(main_keyword: str, sub_keywords: str, structured_data: Dict, content_type: str = "ì •ë³´/ê°€ì´ë“œí˜•", tone: str = "ì •ì¤‘í•œ ì¡´ëŒ“ë§ì²´", review_detail: str = "") -> str:
        """ë„¤ì´ë²„ SEO ìµœì í™” ì½˜í…ì¸  ë¶„ì„ ê¸°ë°˜ AI í”„ë¡¬í”„íŠ¸ ìƒì„± (ì»¨í…ì¸  ìœ í˜•ê³¼ ë§íˆ¬, í›„ê¸° ì„¸ë¶€ ìœ í˜• ë°˜ì˜)"""
        
        competitor_info = structured_data.get("competitor_analysis", {})
        top_blogs = competitor_info.get("top_blogs", [])
        summary = competitor_info.get("summary", {})
        
        # ì»¨í…ì¸  ìœ í˜•ë³„ ì§€ì¹¨ (ë„¤ì´ë²„ SEO ìµœì í™”)
        content_guidelines = {
            "í›„ê¸°/ë¦¬ë·°í˜•": {
                "approach": "ê°œì¸ ê²½í—˜ê³¼ ì†”ì§í•œ í›„ê¸°ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ 'ìœ ì¼ë¬´ì´í•œ ì½˜í…ì¸ ' ì‘ì„±",
                "structure": "ì‚¬ìš© ì „ ê³ ë¯¼ â†’ ì§ì ‘ ì‚¬ìš© ê²½í—˜ â†’ ì¥ë‹¨ì  ì†”ì§ í›„ê¸° â†’ ìµœì¢… í‰ê°€ ë° ì¶”ì²œ",
                "keywords": ["ì§ì ‘ ì¨ë´¤ì–´ìš”", "ì†”ì§ í›„ê¸°", "ê°œì¸ì ìœ¼ë¡œ", "ì‹¤ì œë¡œ ì‚¬ìš©í•´ë³´ë‹ˆ", "ì¶”ì²œí•˜ëŠ” ì´ìœ "],
                "detailed_tips": [
                    "ğŸŒŸ ê°œì¸ì˜ ê³ ìœ í•œ ìŠ¤í† ë¦¬ì™€ ê°ì •ì„ ìƒì„¸íˆ ë‹´ì•„ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ì— ìµœì í™”",
                    "ìƒìƒí•œ ë¬˜ì‚¬: ì œí’ˆ/ì„œë¹„ìŠ¤ ì‚¬ìš© ì „í›„ ë³€í™”ë¥¼ êµ¬ì²´ì  ì—í”¼ì†Œë“œë¡œ ì„œìˆ ",
                    "ê°ê´€ì  ì •ë³´ì™€ ì£¼ê´€ì  í‰ê°€ ê· í˜•: ì¥ë‹¨ì  ëª…í™• ì œì‹œ, ë³„ì /í‰ì  í¬í•¨",
                    "ì œí’ˆ ì œê³µ ë°©ì‹ ëª…ì‹œ: ìë¹„ êµ¬ë§¤, í˜‘ì°¬, ì²´í—˜ë‹¨ ë“± íˆ¬ëª…í•˜ê²Œ ê³µê°œí•˜ì—¬ ì‹ ë¢°ì„± í™•ë³´",
                    "ì‹¤ì œ ì‚¬ìš© ëª¨ìŠµì˜ ê³ í’ˆì§ˆ ì‚¬ì§„/ì˜ìƒ (AI ìƒì„± ì´ë¯¸ì§€ë³´ë‹¤ ì‹¤ì œ ì‚¬ìš© ì‚¬ì§„)",
                    "ì‚¬ìš© ê¸°ê°„, íšŸìˆ˜, ë¹„ìš© ë“± êµ¬ì²´ì  ìˆ˜ì¹˜ì™€ ë°ì´í„° ì œê³µ",
                    "Before & After ëª…í™•í•œ ë¹„êµ íš¨ê³¼ ì„¤ëª…"
                ]
            },
            "ì •ë³´/ê°€ì´ë“œí˜•": {
                "approach": "ì •í™•í•˜ê³  í’ë¶€í•œ ì •ë³´ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì œê³µí•˜ì—¬ ê²€ìƒ‰ìì˜ ê¶ê¸ˆì¦ ì™„ì „ í•´ê²°",
                "structure": "ë¬¸ì œ ì •ì˜ â†’ í•´ê²°ì±… ì œì‹œ â†’ ë‹¨ê³„ë³„ ê°€ì´ë“œ â†’ ì£¼ì˜ì‚¬í•­ â†’ ë§ˆë¬´ë¦¬",
                "keywords": ["ì™„ë²½ ì •ë¦¬", "ì´ì •ë¦¬", "í•µì‹¬ í¬ì¸íŠ¸", "ë‹¨ê³„ë³„ ê°€ì´ë“œ", "ì •í™•í•œ ì •ë³´"],
                "detailed_tips": [
                    "ğŸ“š ëª…í™•í•œ êµ¬ì¡°: ì„œë¡ -ë³¸ë¡ -ê²°ë¡  + ì†Œì œëª©(H2, H3) ì ê·¹ í™œìš©ìœ¼ë¡œ ê²€ìƒ‰ ìµœì í™”",
                    "ê°ê´€ì  ë°ì´í„°ì™€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ìë£Œ ê¸°ë°˜ ì •ë³´ ì œê³µ",
                    "ë‹¨ê³„ë³„ ì„¤ëª…, ë¹„êµí‘œ, ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ì‹¤ìš©ì  ê°€ì¹˜ ê·¹ëŒ€í™”",
                    "ê´€ë ¨ ê²€ìƒ‰ì–´ë¥¼ ì†Œì œëª©ê³¼ ë³¸ë¬¸ì— ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨í•˜ì—¬ ê²€ìƒ‰ ë…¸ì¶œ ì¦ëŒ€",
                    "ì¤‘ìš”í•œ ì •ë³´ëŠ” êµµì€ ê¸€ì”¨ë‚˜ ì¸ìš© í˜•íƒœë¡œ ê°•ì¡°í•˜ì—¬ ê°€ë…ì„± í–¥ìƒ",
                    "ë…ìê°€ ë°”ë¡œ ë”°ë¼í•  ìˆ˜ ìˆëŠ” êµ¬ì²´ì  ì‹¤í–‰ ë°©ë²• ì œì‹œ",
                    "ì „ë¬¸ ìš©ì–´ ì‰½ê²Œ í’€ì–´ì„œ ì„¤ëª…, ì‹œê°„/ë¹„ìš© ë“± í˜„ì‹¤ì  ì •ë³´ í¬í•¨"
                ]
            },
            "ë¹„êµ/ì¶”ì²œí˜•": {
                "approach": "ì²´ê³„ì  ë¹„êµë¶„ì„ìœ¼ë¡œ ë…ìì˜ ì„ íƒ ê³ ë¯¼ì„ ì™„ì „íˆ í•´ê²°",
                "structure": "ë¹„êµ ê¸°ì¤€ ì œì‹œ â†’ ê° ì˜µì…˜ ë¶„ì„ â†’ ì¥ë‹¨ì  ë¹„êµ â†’ ìƒí™©ë³„ ì¶”ì²œ â†’ ìµœì¢… ê²°ë¡ ",
                "keywords": ["VS ë¹„êµ", "Best 5", "ì¥ë‹¨ì ", "ìƒí™©ë³„ ì¶”ì²œ", "ê°€ì„±ë¹„"],
                "detailed_tips": [
                    "âš–ï¸ ì²´ê³„ì  ë¹„êµ í•­ëª©: ê°€ê²©, ì„±ëŠ¥, ì¥ë‹¨ì , ëŒ€ìƒ ë“± ê°ê´€ì  ê¸°ì¤€ ëª…ì‹œ",
                    "ë¹„êµí‘œ í™œìš©í•˜ì—¬ í•œëˆˆì— ë³´ëŠ” íŠ¹ì§• ì •ë¦¬ (ê°€ë…ì„±ê³¼ ì •ë³´ ì „ë‹¬ë ¥ ê·¹ëŒ€í™”)",
                    "ìƒí™©ë³„ ë§ì¶¤ ì¶”ì²œ: ê°€ì„±ë¹„ ì¤‘ì‹œ, íŠ¹ì • ê¸°ëŠ¥ ì„ í˜¸, ì´ˆë³´ììš© ë“± êµ¬ì²´ì  ë¶„ë¥˜",
                    "ê°ê´€ì  ê·¼ê±° ì œì‹œ: ì‹¤ì œ ì‚¬ìš©ì í›„ê¸°, í‰ì , íŒë§¤ëŸ‰ ë“± ë°ì´í„° í™œìš©",
                    "ì¹´í…Œê³ ë¦¬ë³„ 1ìœ„ ì„ ì •: ê°€ì„±ë¹„ ìµœê³ , ì„±ëŠ¥ ìµœê³ , ë””ìì¸ ìµœê³  ë“±",
                    "ê²°ë¡ ì—ì„œ ëª…í™•í•œ ì„ íƒ ê°€ì´ë“œì™€ ìµœì¢… ì¶”ì²œ ìˆœìœ„ ì œì‹œ",
                    "êµ¬ë§¤ ì‹œ ì²´í¬í¬ì¸íŠ¸ì™€ ì£¼ì˜ì‚¬í•­ ìƒì„¸ ì•ˆë‚´"
                ]
            }
        }
        
        # í›„ê¸° ì„¸ë¶€ ìœ í˜•ë³„ ì§€ì¹¨ (í›„ê¸°/ë¦¬ë·°í˜•ì¼ ë•Œ ì ìš©)
        review_detail_guidelines = {
            "ë‚´ëˆë‚´ì‚° í›„ê¸°": {
                "description": "ì§ì ‘ êµ¬ë§¤í•´ì„œ ì¨ë³¸ ì†”ì§í•œ ê°œì¸ í›„ê¸°",
                "key_points": [
                    "ğŸ’° 'ì§ì ‘ êµ¬ë§¤í•´ì„œ ì¨ë³¸ í›„ê¸°'ì„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì–¸ê¸‰",
                    "êµ¬ë§¤í•˜ê²Œ ëœ ì´ìœ ì™€ ê³ ë¯¼í–ˆë˜ ì ë“¤ì„ ì†”ì§í•˜ê²Œ í‘œí˜„",
                    "ì‹¤ì œ ì‚¬ìš©í•´ë³´ë©´ì„œ ëŠë‚€ ì¥ì ê³¼ ì•„ì‰¬ìš´ ì  ê· í˜•ìˆê²Œ ì„œìˆ ",
                    "ê°€ì„±ë¹„ì— ëŒ€í•œ ê°œì¸ì  í‰ê°€ì™€ ì¶”ì²œ ì—¬ë¶€",
                    "ë¹„ìŠ·í•œ ì œí’ˆê³¼ ë¹„êµí–ˆì„ ë•Œì˜ ì°¨ì´ì ",
                    "ì¬êµ¬ë§¤ ì˜í–¥ì´ë‚˜ ì§€ì¸ ì¶”ì²œ ì˜í–¥ í¬í•¨"
                ],
                "transparency": "ê°œì¸ êµ¬ë§¤ë¡œ í¸ê²¬ ì—†ëŠ” ì†”ì§í•œ í›„ê¸°ì„ì„ ê°•ì¡°"
            },
            "í˜‘ì°¬ í›„ê¸°": {
                "description": "ë¸Œëœë“œì—ì„œ ì œê³µë°›ì€ ì œí’ˆì˜ ì •ì§í•œ ë¦¬ë·°",
                "key_points": [
                    "ğŸ¤ 'ë¸Œëœë“œë¡œë¶€í„° ì œí’ˆì„ ì œê³µë°›ì•„ ì‘ì„±í•œ í›„ê¸°'ì„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì–¸ê¸‰",
                    "í˜‘ì°¬ì´ì§€ë§Œ ì†”ì§í•˜ê³  ê³µì •í•œ í‰ê°€ë¥¼ í•˜ê² ë‹¤ëŠ” ì˜ì§€ í‘œí˜„",
                    "ì œí’ˆì˜ ì¥ì ê³¼ ì•„ì‰¬ìš´ ì ì„ ê· í˜•ìˆê²Œ ì„œìˆ í•˜ëŠ” êµ¬ì¡°",
                    "ë…ì ì…ì¥ì—ì„œ ê°ê´€ì ìœ¼ë¡œ í‰ê°€í•˜ëŠ” ê´€ì ",
                    "ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ì™€ ëŠë‚€ ì ë“¤ì„ ìƒì„¸íˆ í‘œí˜„",
                    "í˜‘ì°¬ ê´€ê³„ë¥¼ ë– ë‚˜ ì†”ì§í•œ ì˜ê²¬ ì œì‹œí•˜ëŠ” í†¤"
                ],
                "transparency": "í˜‘ì°¬ ì œí’ˆì´ì§€ë§Œ ê³µì •í•˜ê³  ì†”ì§í•œ ë¦¬ë·° ì œê³µ"
            },
            "ì²´í—˜ë‹¨ í›„ê¸°": {
                "description": "ì²´í—˜ë‹¨ ì°¸ì—¬ë¥¼ í†µí•œ ì œí’ˆ ì‚¬ìš© í›„ê¸°",
                "key_points": [
                    "ğŸ‘¥ 'ì²´í—˜ë‹¨ì— ì°¸ì—¬í•˜ì—¬ ì‘ì„±í•œ í›„ê¸°'ì„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì–¸ê¸‰",
                    "ì²´í—˜ ê¸°íšŒë¥¼ ì–»ê²Œ ëœ ê²ƒì— ëŒ€í•œ ê°ì‚¬í•¨ í‘œí˜„",
                    "ì œí’ˆì„ ê¼¼ê¼¼íˆ í…ŒìŠ¤íŠ¸í•´ë³¸ ê³¼ì •ê³¼ ëŠë‚€ ì  ì„œìˆ ",
                    "ì²´í—˜ë‹¨ìœ¼ë¡œì„œ ê°ê´€ì ì´ê³  ê³µì •í•œ í‰ê°€ ì˜ì§€ í‘œí˜„",
                    "ì¼ë°˜ êµ¬ë§¤ ê³ ê° ì…ì¥ì—ì„œì˜ ì†”ì§í•œ ì˜ê²¬ ì œì‹œ",
                    "ì²´í—˜ë‹¨ í›„ê¸°ì§€ë§Œ í¸ê²¬ ì—†ëŠ” ê· í˜•ì¡íŒ ë¦¬ë·° ì‘ì„±"
                ],
                "transparency": "ì²´í—˜ë‹¨ ì°¸ì—¬ í›„ê¸°ì˜ íŠ¹ì„±ê³¼ í•œê³„ë¥¼ íˆ¬ëª…í•˜ê²Œ ê³µê°œ"
            },
            "ëŒ€ì—¬/ë Œíƒˆ í›„ê¸°": {
                "description": "ë Œíƒˆ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•œ ì œí’ˆ ì‚¬ìš© í›„ê¸°",
                "key_points": [
                    "ğŸ”„ 'ë Œíƒˆ ì„œë¹„ìŠ¤ë¡œ ì´ìš©í•´ë³¸ í›„ê¸°'ì„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì–¸ê¸‰",
                    "ë Œíƒˆì„ ì„ íƒí•œ ì´ìœ ì™€ ê³ ë¯¼í–ˆë˜ ì ë“¤ í‘œí˜„",
                    "ë Œíƒˆ ì„œë¹„ìŠ¤ì˜ ì¥ì ê³¼ ì•„ì‰¬ì› ë˜ ì  ê· í˜•ìˆê²Œ ì„œìˆ ",
                    "ë Œíƒˆê³¼ êµ¬ë§¤ì˜ ì°¨ì´ì ì— ëŒ€í•œ ê°œì¸ì  ì˜ê²¬",
                    "ê²½ì œì„±ê³¼ í¸ì˜ì„± ì¸¡ë©´ì—ì„œì˜ í‰ê°€",
                    "ì–´ë–¤ ìƒí™©ì— ë Œíƒˆì´ ì í•©í• ì§€ì— ëŒ€í•œ ì˜ê²¬ ì œì‹œ"
                ],
                "transparency": "ë Œíƒˆ ì„œë¹„ìŠ¤ íŠ¹ì„±ìƒ ì œí•œì  ì‚¬ìš© í›„ê¸°ì„ì„ ëª…í™•íˆ ì•ˆë‚´"
            }
        }
        
        # ë§íˆ¬ë³„ ì§€ì¹¨
        tone_guidelines = {
            "ì¹œê·¼í•œ ë°˜ë§ì²´": {
                "style": "ì¹œêµ¬ì™€ ëŒ€í™”í•˜ë“¯ í¸ì•ˆí•˜ê³  ì¹œê·¼í•œ ë§íˆ¬",
                "examples": ["ì¨ë´¤ëŠ”ë° ì§„ì§œ ì¢‹ë”ë¼~", "ì™„ì „ ê°•ì¶”!", "ì†”ì§íˆ ë§í•˜ë©´", "ì´ê±° ì§„ì§œ ëŒ€ë°•ì´ì•¼"],
                "ending": "ëŒ“ê¸€ë¡œ ê¶ê¸ˆí•œ ê±° ë¬¼ì–´ë´!",
                "sentence_style": "ì§§ê³  ë¦¬ë“œë¯¸ì»¬í•œ ë¬¸ì¥",
                "detailed_tips": [
                    "ê°íƒ„ì‚¬ì™€ ì˜ì„±ì–´ë¥¼ ì ì ˆíˆ í™œìš© (ì™€~, í—‰!, ìŒìŒ)",
                    "ì¤„ì„ë§ê³¼ ì‹ ì¡°ì–´ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ì‚¬ìš© (ê°“í…œ, í•µê¿€í…œ, ë ˆê²Œë…¸)",
                    "ì´ëª¨í‹°ì½˜ ëŒ€ì‹  ë¬¸ìë¡œ ê°ì • í‘œí˜„ (~, !, ?ë¥¼ í™œìš©)",
                    "ê°œì¸ì  ê²½í—˜ì„ ë§ì´ ë„£ì–´ ì¹œë°€ê° ì¡°ì„±",
                    "ë…ìë¥¼ ì¹œêµ¬ì²˜ëŸ¼ ë¶€ë¥´ë©° ê³µê°ëŒ€ í˜•ì„±",
                    "ì–´ë ¤ìš´ ë‚´ìš©ë„ ì‰½ê³  ì¬ë¯¸ìˆê²Œ í’€ì–´ì„œ ì„¤ëª…",
                    "ë†ë‹´ì´ë‚˜ ìœ ë¨¸ë¥¼ ì ì ˆíˆ ì„ì–´ ì¬ë¯¸ ìš”ì†Œ ì¶”ê°€"
                ]
            },
            "ì •ì¤‘í•œ ì¡´ëŒ“ë§ì²´": {
                "style": "ì •ì¤‘í•˜ê³  ì˜ˆì˜ ë°”ë¥¸ ì¡´ëŒ“ë§ë¡œ ì‹ ë¢°ê° ì¡°ì„±",
                "examples": ["ì‚¬ìš©í•´ë³´ì•˜ìŠµë‹ˆë‹¤", "ì¶”ì²œë“œë¦½ë‹ˆë‹¤", "ë„ì›€ì´ ë˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤", "ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤"],
                "ending": "ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. ê¶ê¸ˆí•œ ì ì€ ëŒ“ê¸€ë¡œ ë¬¸ì˜í•´ ì£¼ì„¸ìš”.",
                "sentence_style": "ì •ì¤‘í•˜ê³  ì™„ì „í•œ ë¬¸ì¥",
                "detailed_tips": [
                    "ëª¨ë“  ë¬¸ì¥ì„ ì¡´ëŒ“ë§ë¡œ ì¼ê´€ì„± ìˆê²Œ ì‘ì„±",
                    "ì •ì¤‘í•œ í‘œí˜„ê³¼ ê²¸ì†í•œ íƒœë„ ìœ ì§€",
                    "ë…ìë¥¼ ë°°ë ¤í•˜ëŠ” ë§ˆìŒê°€ì§ì´ ë“œëŸ¬ë‚˜ëŠ” í‘œí˜„ ì‚¬ìš©",
                    "í™•ì‹ ë³´ë‹¤ëŠ” '~ê²ƒ ê°™ìŠµë‹ˆë‹¤', '~ë¡œ ë³´ì…ë‹ˆë‹¤' ë“± ê²¸ì†í•œ í‘œí˜„",
                    "ì „ë¬¸ì ì´ë©´ì„œë„ ì–´ë µì§€ ì•Šì€ ì ì ˆí•œ ì–´íœ˜ ì„ íƒ",
                    "ë…ìì˜ ìƒí™©ì„ ê³ ë ¤í•œ ë°°ë ¤ ê¹Šì€ ì¡°ì–¸ ì œê³µ",
                    "ì •ë³´ ì œê³µ ì‹œ ì¶œì²˜ë‚˜ ê·¼ê±°ë¥¼ ëª…í™•íˆ ì œì‹œ"
                ]
            },
            "ì¹œê·¼í•œ ì¡´ëŒ“ë§ì²´": {
                "style": "ì¹œê·¼í•˜ê³  ë¶€ë“œëŸ¬ìš´ ì¡´ëŒ“ë§ë¡œ ë”°ëœ»í•œ ëŠë‚Œ",
                "examples": ["ê¶ê¸ˆí•´ì„œ ì°¾ì•„ë´¤ì–´ìš”", "ì¨ë´¤ëŠ”ë° ì¢‹ë”ë¼êµ¬ìš”", "ì´ëŸ° ê²Œ ìˆë”ë¼êµ¬ìš”", "ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”"],
                "ending": "ë„ì›€ì´ ë˜ì…¨ìœ¼ë©´ ì¢‹ê² ì–´ìš”~ ê¶ê¸ˆí•œ ê²Œ ìˆìœ¼ì‹œë©´ ëŒ“ê¸€ ë‚¨ê²¨ì£¼ì„¸ìš”!",
                "sentence_style": "ë¶€ë“œëŸ½ê³  ë”°ëœ»í•œ ì¡´ëŒ“ë§ ë¬¸ì¥",
                "detailed_tips": [
                    "'~í–ˆì–´ìš”', '~ë”ë¼êµ¬ìš”', '~ê²ƒ ê°™ì•„ìš”' ë“± ë¶€ë“œëŸ¬ìš´ ì¡´ëŒ“ë§ í™œìš©",
                    "ë…ìë¥¼ ë°°ë ¤í•˜ëŠ” ì¹œê·¼í•˜ê³  ë”°ëœ»í•œ ì–´ì¡° ìœ ì§€",
                    "ê°œì¸ì  ê²½í—˜ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë…¹ì—¬ì„œ ì¹œë°€ê° í˜•ì„±",
                    "ì–´ë ¤ìš´ ë‚´ìš©ë„ ì‰½ê³  ì¹œê·¼í•˜ê²Œ ì„¤ëª…í•˜ëŠ” ì ‘ê·¼",
                    "ë…ìì˜ ì…ì¥ì„ ì´í•´í•˜ê³  ê³µê°í•˜ëŠ” í‘œí˜„ ì‚¬ìš©",
                    "ì •ë³´ ì „ë‹¬ ì‹œì—ë„ ë¶€ë‹´ìŠ¤ëŸ½ì§€ ì•Šì€ ì˜¨í™”í•œ í†¤ ìœ ì§€",
                    "ë§ˆë¬´ë¦¬ëŠ” í•­ìƒ ë”°ëœ»í•˜ê³  ë„ì›€ë˜ëŠ” ë§ˆìŒìœ¼ë¡œ ì‘ì„±"
                ]
            }
        }
        
        current_content = content_guidelines.get(content_type, content_guidelines["ì •ë³´/ê°€ì´ë“œí˜•"])
        current_tone = tone_guidelines.get(tone, tone_guidelines["ì •ì¤‘í•œ ì¡´ëŒ“ë§ì²´"])
        
        # í›„ê¸° ì„¸ë¶€ ìœ í˜• ì •ë³´ (í›„ê¸°/ë¦¬ë·°í˜•ì¼ ë•Œë§Œ ì ìš©)
        current_review_detail = None
        if content_type == "í›„ê¸°/ë¦¬ë·°í˜•" and review_detail:
            current_review_detail = review_detail_guidelines.get(review_detail)
        
        # í‰ê·  íƒœê·¸ ê°œìˆ˜ ê³„ì‚°
        avg_tag_count = sum(len(blog.get("tags", [])) for blog in top_blogs) // max(1, len(top_blogs)) if top_blogs else 5
        
        # í‰ê·  ì´ë¯¸ì§€ ê°œìˆ˜ ê³„ì‚°
        avg_image_count = sum(blog.get("statistics", {}).get("image_count", 0) for blog in top_blogs) // max(1, len(top_blogs)) if top_blogs else 3
        
        prompt = f"""
# ğŸ­ AI ì—­í•  ì„¤ì •
ë‹¹ì‹ ì€ 15ë…„ ê²½ë ¥ì˜ ë„¤ì´ë²„ ë¸”ë¡œê·¸ ì „ë¬¸ê°€ì´ì SEO ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë„¤ì´ë²„ì˜ ìµœì‹  ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ì— ìµœì í™”ëœ ìƒìœ„ ë…¸ì¶œ ì½˜í…ì¸ ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

# ğŸ“ ì‘ì—… ëª©í‘œ
**ë©”ì¸ í‚¤ì›Œë“œ**: "{main_keyword}"
**ë³´ì¡° í‚¤ì›Œë“œ**: "{sub_keywords if sub_keywords.strip() else 'ë©”ì¸ í‚¤ì›Œë“œì™€ ê´€ë ¨ëœ ë³´ì¡° í‚¤ì›Œë“œë“¤ì„ 3-5ê°œ ì§ì ‘ ìƒì„±í•˜ì—¬ í™œìš©'}"
**ë¯¸ì…˜**: ê²€ìƒ‰ìê°€ "ì´ ê¸€ ë„ˆë¬´ ì¢‹ë‹¤!"ë¼ê³  ëŠë‚„ ë§Œí•œ ìœ ì¼ë¬´ì´í•œ ë¸”ë¡œê·¸ ì½˜í…ì¸  ì‘ì„±

## ğŸ“Š ê²½ìŸì‚¬ ë¶„ì„ ë°ì´í„°
### ìƒìœ„ {len(top_blogs)}ê°œ ë¸”ë¡œê·¸ ë¶„ì„ ê²°ê³¼:"""

        # ê²½ìŸì‚¬ ë°ì´í„°ë¥¼ ë¨¼ì € ë³´ì—¬ì¤Œ
        for i, blog in enumerate(top_blogs, 1):
            prompt += f"""
**{i}ìœ„ ë¸”ë¡œê·¸:**
- ì œëª©: {blog['title']}
- ê¸€ììˆ˜: {blog['statistics']['content_length']}ì
- ì´ë¯¸ì§€: {blog['statistics']['image_count']}ê°œ, GIF: {blog['statistics']['gif_count']}ê°œ, ë™ì˜ìƒ: {blog['statistics']['video_count']}ê°œ
- íƒœê·¸: {', '.join(blog['tags'][:5])}{'...' if len(blog['tags']) > 5 else ''}
- ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°: {blog['content_preview']}
"""
        
        prompt += f"""

## ğŸ¨ ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼ ê°€ì´ë“œë¼ì¸
**ì»¨í…ì¸  ìœ í˜•:** {content_type}
- **ì ‘ê·¼ë²•:** {current_content['approach']}
- **êµ¬ì¡°:** {current_content['structure']}
- **í•µì‹¬ í‚¤ì›Œë“œ:** {', '.join(current_content['keywords'])}

**ë§íˆ¬ ìŠ¤íƒ€ì¼:** {tone}
- **ìŠ¤íƒ€ì¼:** {current_tone['style']}
- **ì˜ˆì‹œ í‘œí˜„:** {', '.join(current_tone['examples'])}
- **ë¬¸ì¥ íŠ¹ì§•:** {current_tone['sentence_style']}
- **ë§ˆë¬´ë¦¬ ë¬¸êµ¬:** {current_tone['ending']}"""
        
        prompt += f"""

## ğŸ“‹ SEO ìµœì í™” ì›ì¹™ (ë°˜ë“œì‹œ ì¤€ìˆ˜)
1. **ì œëª© ì‘ì„±**: ì œê³µëœ ìƒìœ„ ë¸”ë¡œê·¸ 3ê°œì˜ ì œëª©ê³¼ ìœ ì‚¬í•˜ì§€ ì•Šìœ¼ë©´ì„œë„ ë…ì°½ì ì´ê³  ë§¤ë ¥ì ì¸ ì œëª©ì„ ìƒì„±í•´ ì£¼ì„¸ìš”. ë©”ì¸í‚¤ì›Œë“œëŠ” ë„£ë˜ ìì—°ìŠ¤ëŸ½ê²Œ ë°°ì¹˜
2. **ê¸€ì ìˆ˜**: ìƒìœ„ ë…¸ì¶œëœ 1~3ìœ„ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì˜ í‰ê·  ê¸€ì ìˆ˜({summary.get('avg_content_length', 1500)}ì)ë¥¼ ë¶„ì„í•˜ì—¬ ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìµœì í™”í•´ ì£¼ì„¸ìš”. ì¼ë°˜ì ìœ¼ë¡œ 1,500ìì—ì„œ 2,000ì(ê³µë°± ì œì™¸) ì‚¬ì´ê°€ ì í•©í•˜ë©°, 2,000ìë¥¼ ë„˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ ì£¼ì„¸ìš”
3. **í‚¤ì›Œë“œ ë°˜ë³µ**: ë©”ì¸ í‚¤ì›Œë“œ 5-6íšŒ, ë³´ì¡° í‚¤ì›Œë“œë“¤ ê°ê° 3-4íšŒ ìì—°ìŠ¤ëŸ½ê²Œ ë°˜ë³µ (ë³´ì¡°í‚¤ì›Œë“œê°€ ì œê³µë˜ì§€ ì•Šì€ ê²½ìš° ë©”ì¸ í‚¤ì›Œë“œì™€ ê´€ë ¨ëœ ë³´ì¡° í‚¤ì›Œë“œë¥¼ 3-5ê°œ ì§ì ‘ ìƒì„±í•˜ì—¬ í™œìš©)
4. **3ì´ˆì˜ ë²•ì¹™**: ê¸€ ì´ˆë°˜ì— ë…ìê°€ ì›í•˜ëŠ” í•µì‹¬ ì •ë³´ë¥¼ ëª…í™•íˆ ì œì‹œí•˜ì—¬ í¥ë¯¸ë¥¼ ìœ ë°œí•©ë‹ˆë‹¤
5. **ì„œë¡  í‚¤ì›Œë“œ**: ê¸€ ì„œë¡  ë¶€ë¶„ì— íƒ€ê²Ÿ í‚¤ì›Œë“œë¥¼ ë°˜ë“œì‹œ ì–¸ê¸‰í•´ ì£¼ì„¸ìš”
6. **ì†Œì œëª© í™œìš©**: ì†Œì œëª©ì— í•„ìˆ˜ í‚¤ì›Œë“œë¥¼ ì‚½ì…í•˜ë©´ ìŠ¤ë§ˆíŠ¸ ë¸”ë¡ ë…¸ì¶œì— ìœ ë¦¬í•©ë‹ˆë‹¤
7. **ì´ë¯¸ì§€ ë°°ì¹˜**: ìƒìœ„ 1~3ìœ„ ë¸”ë¡œê·¸ ê¸€ì˜ ì´ë¯¸ì§€ ìˆ˜ë¥¼ ì°¸ê³ í•˜ì—¬ ì ì ˆí•œ ìˆ˜ì˜ ì´ë¯¸ì§€ë¥¼ ë°°ì¹˜í•  ê³„íšì´ë©°, ì´ ê¸€ì—ëŠ” {avg_image_count}ì¥ ì´ìƒì˜ ì´ë¯¸ì§€ë¥¼ ì‚½ì…í•  ì˜ˆì •ì…ë‹ˆë‹¤. (ì´ë¯¸ì§€) í‘œì‹œë¡œ ìœ„ì¹˜ ì§€ì •í•˜ë˜, í•„ìš”ì‹œ ì—°ì†ìœ¼ë¡œ ì—¬ëŸ¬ ì¥ ì‚½ì… ê°€ëŠ¥ (ì˜ˆ: (ì´ë¯¸ì§€)(ì´ë¯¸ì§€)(ì´ë¯¸ì§€)(ì´ë¯¸ì§€) ë“± ìµœëŒ€ 4ì¥ê¹Œì§€ ì—°ì† ë°°ì¹˜ í—ˆìš©)
8. **ë™ì˜ìƒ í¬í•¨**: ë™ì˜ìƒì€ ìµœì†Œ 1ê°œ ì´ìƒ í¬í•¨í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•˜ë©°, ë™ì˜ìƒ ì œëª©ì—ë„ í‚¤ì›Œë“œë¥¼ ë„£ì–´ ìœ ì… ê²½ë¡œë¥¼ ëŠ˜ë ¤ì£¼ì„¸ìš”. ë™ì˜ìƒì€ (ë™ì˜ìƒ)ìœ¼ë¡œ í‘œì‹œ
9. **ê²½ìŸì‚¬ ì°¨ë³„í™”**: ìƒìœ„ ë¸”ë¡œê·¸ë“¤ë³´ë‹¤ ë” í’ë¶€í•˜ê³  êµ¬ì²´ì ì¸ ë‚´ìš© ì‘ì„±

## ğŸ“– ê¸€ì˜ êµ¬ì„± ë° íë¦„
1. **ì„œë¡ (10-15%)**: ë…ìì˜ ê´€ì‹¬ì„ ëŒê³  ë¬¸ì œë¥¼ ì œì‹œí•˜ë©°, ì´ˆë°˜ 3ì´ˆ ë‚´ì— ë…ìê°€ ì›í•˜ëŠ” í•µì‹¬ ì •ë³´ë¥¼ ëª…í™•íˆ ì œì‹œí•˜ê³ , ê°œì¸ì˜ ê²½í—˜ì´ë‚˜ ê°ì •ì„ ë‹´ì•„ ê³µê°ëŒ€ë¥¼ í˜•ì„±í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‹œì‘í•´ ì£¼ì„¸ìš”. íƒ€ê²Ÿ í‚¤ì›Œë“œë¥¼ ë°˜ë“œì‹œ ì–¸ê¸‰í•´ì•¼ í•©ë‹ˆë‹¤.
2. **ë³¸ë¡ (70-80%)**: êµ¬ì²´ì ì¸ ì •ë³´ì™€ í•´ê²°ì±…ì„ ì œê³µí•˜ë©°, ë…ìê°€ ì›í•˜ëŠ” ì •ë³´ë¥¼ ì¶©ë¶„íˆ ì œê³µí•˜ê³ , ê¸€ì˜ íë¦„ì„ ë°©í•´í•˜ì§€ ì•ŠëŠ” ì„ ì—ì„œ ê´€ë ¨ ë‚´ìš©ì„ ìì—°ìŠ¤ëŸ½ê²Œ í’€ì–´ë‚´ì„¸ìš”. ë‹¤ì´ì•„ ë¡œì§ì— ë”°ë¼ ìœ ì¼ë¬´ì´í•œ ì½˜í…ì¸ ê°€ ë˜ë„ë¡ ìì‹ ë§Œì˜ ì „ë¬¸ì„±ì´ë‚˜ ìŠ¤í† ë¦¬ë¥¼ ë‹´ì•„ì£¼ì„¸ìš”.
3. **ê²°ë¡ (10-15%)**: ë‚´ìš©ì„ ìš”ì•½í•˜ê³  ë…ìì˜ í–‰ë™(ì˜ˆ: ëŒ“ê¸€, êµ¬ë§¤ ë“±)ì„ ìœ ë„í•˜ëŠ” ë¬¸êµ¬ë¥¼ í¬í•¨í•˜ì—¬ ë§ˆë¬´ë¦¬í•´ ì£¼ì„¸ìš”.
4. **ë¬¸ë‹¨ êµ¬ë¶„**: ë¬¸ì¥ì„ ë‘ ì„¸ ê°œ ì •ë„ ì´ì–´ì„œ ë¬¸ë‹¨ì˜ í˜•íƒœë¡œ ì‘ì„±í•˜ê³ , ë¬¸ë‹¨ êµ¬ë¶„ì„ í™•ì‹¤íˆ í•´ ì£¼ì„¸ìš”.

## â±ï¸ ì²´ë¥˜ ì‹œê°„ ê·¹ëŒ€í™” ì „ëµ
1. **ì‹œê° ìë£Œ ì ê·¹ í™œìš©**: ê¸´ í…ìŠ¤íŠ¸ë¥¼ ë‚˜ëˆ„ëŠ” ìš©ë„ë¡œ ì´ë¯¸ì§€ë¥¼ ì ì ˆíˆ ì‚½ì…í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì´ê³ , ë…ìì˜ í¥ë¯¸ë¥¼ ìœ ë°œí•˜ì„¸ìš”.
2. **ë‚´ë¶€ ë§í¬ í™œìš©**: ê´€ë ¨ëœ ë‹¤ë¥¸ í¬ìŠ¤íŒ…ìœ¼ë¡œ ì—°ê²°ë˜ëŠ” ë‚´ë¶€ ë§í¬ë¥¼ í™œìš©í•˜ì—¬ ë…ìê°€ ë¸”ë¡œê·¸ ë‚´ì—ì„œ ë” ë§ì€ ì‹œê°„ì„ ë³´ë‚´ë„ë¡ ìœ ë„í•´ ì£¼ì„¸ìš”.
3. **ì†Œí†µ ìœ ë„**: ëŒ“ê¸€ê³¼ ì†Œí†µì„ ìœ ë„í•˜ëŠ” ë¬¸êµ¬ë¥¼ í¬í•¨í•˜ì—¬ ì²´ë¥˜ ì‹œê°„ì„ ëŠ˜ë¦¬ì„¸ìš”. (ì˜ˆ: "ê¶ê¸ˆí•œ ì ì€ ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì„¸ìš”.")

## ğŸ‘¤ ê°œì¸ì  í„°ì¹˜ì™€ ë…ì°½ì„± ê°•í™”
ìƒì„±ëœ ì½˜í…ì¸ ì— ë°˜ë“œì‹œ ë‹¤ìŒ ìš”ì†Œë“¤ì„ í¬í•¨í•˜ì—¬ ì¸ê°„ì ì´ê³  ì‹ ë¢°ê° ìˆëŠ” ê¸€ë¡œ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤:
- **ê°œì¸ ê²½í—˜ ìŠ¤í† ë¦¬**: ì‹¤ì œ ê²ªì€ ì¼í™”ë‚˜ ëŠë‚Œì„ ìì—°ìŠ¤ëŸ½ê²Œ ë…¹ì—¬ë‚´ê¸°
- **ê°ì •ì  í‘œí˜„**: ì†”ì§í•œ ê°ì •ê³¼ ê°œì¸ì  ì˜ê²¬ì„ ì ì ˆíˆ í‘œí˜„í•˜ì—¬ ê³µê°ëŒ€ í˜•ì„±
- **ê³ ìœ í•œ ê´€ì **: ë‚¨ë“¤ê³¼ ë‹¤ë¥¸ ë…íŠ¹í•œ ì‹œê°ì´ë‚˜ ì ‘ê·¼ ë°©ì‹ ì œì‹œ
- **ì„¸ë¶€ì  ë¬˜ì‚¬**: êµ¬ì²´ì ì¸ ìƒí™©, ìˆ˜ì¹˜, ì‹œê°„ ë“±ì„ í¬í•¨í•œ í˜„ì‹¤ê° ìˆëŠ” ë‚´ìš©
- **ê°œì„± ìˆëŠ” í‘œí˜„**: íšì¼ì ì´ì§€ ì•Šì€ ìì—°ìŠ¤ëŸ¬ìš´ ì–´íˆ¬ì™€ ë¬¸ì²´ ì‚¬ìš©

ì´ëŸ¬í•œ ê°œì¸í™” ì‘ì—…ì„ í†µí•´ ë„¤ì´ë²„ì˜ AI ì½˜í…ì¸  í•„í„°ë§ì„ í”¼í•˜ê³ , ë…ìë“¤ì—ê²Œ ì§„ì •ì„± ìˆëŠ” ì •ë³´ë¡œ ì¸ì‹ë˜ë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.

**ë°˜ë“œì‹œ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ ì™„ì„±ëœ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”:**

### âœ… í•„ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸:
**SEO ìµœì í™”:**
- [ ] ì œëª©ì— ë©”ì¸ í‚¤ì›Œë“œ ìì—°ìŠ¤ëŸ½ê²Œ ë°°ì¹˜ ì™„ë£Œ
- [ ] ì²« ë¬¸ë‹¨ì— í•µì‹¬ ë‹µë³€ ì œì‹œ (3ì´ˆì˜ ë²•ì¹™)
- [ ] ë©”ì¸ í‚¤ì›Œë“œ 5-6íšŒ, ë³´ì¡° í‚¤ì›Œë“œë“¤ ê°ê° 3-4íšŒ ìì—°ìŠ¤ëŸ½ê²Œ ë°˜ë³µ
- [ ] ì†Œì œëª©ì— ê´€ë ¨ í‚¤ì›Œë“œ í¬í•¨í•˜ì—¬ êµ¬ì¡°í™”
- [ ] {max(1500, summary.get('avg_content_length', 1500))}~2,000ì ë²”ìœ„ ì¤€ìˆ˜ (ê³µë°± ì œì™¸)

**ì½˜í…ì¸  í’ˆì§ˆ:**
- [ ] ê°œì¸ ê²½í—˜ ìŠ¤í† ë¦¬ì™€ ê°ì •ì  í‘œí˜„ í¬í•¨
- [ ] êµ¬ì²´ì ì¸ ìˆ˜ì¹˜, ì‹œê°„, ìƒí™© ë“± ì„¸ë¶€ ë¬˜ì‚¬ ì™„ë£Œ
- [ ] ìƒìœ„ ë¸”ë¡œê·¸ ëŒ€ë¹„ ì°¨ë³„í™”ëœ ê´€ì  ì œì‹œ
- [ ] ë…ì í–‰ë™ ìœ ë„ ë¬¸êµ¬ í¬í•¨ (ëŒ“ê¸€, ì†Œí†µ ë“±)

**ê¸°ìˆ ì  ìš”ì†Œ:**
- [ ] ì´ë¯¸ì§€ ì‚½ì… ìœ„ì¹˜ {avg_image_count}ê°œ ì´ìƒ í‘œì‹œ ì™„ë£Œ
- [ ] ë™ì˜ìƒ ì‚½ì… ìœ„ì¹˜ ìµœì†Œ 1ê°œ í‘œì‹œ ì™„ë£Œ
- [ ] ëª¨ë°”ì¼ ê°€ë…ì„± ê³ ë ¤í•œ ë¬¸ë‹¨ êµ¬ì„±
- [ ] íƒœê·¸ {avg_tag_count}ê°œ ì‘ì„± (ë¸Œëœë“œëª… ì œì™¸)

```
**ì œëª©**: [ë©”ì¸í‚¤ì›Œë“œê°€ ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨ëœ ë¾°ì¡±í•˜ê³  ê°„ê²°í•œ ì œëª©]

**ì„œë¡  (ì²« ë¬¸ë‹¨ - 3ì´ˆì˜ ë²•ì¹™)**:
[ë…ìê°€ ì›í•˜ëŠ” í•µì‹¬ ë‹µë³€ì„ ì¦‰ì‹œ ì œì‹œí•˜ê³  ê³µê°ì„ ë¶ˆëŸ¬ì¼ìœ¼í‚¤ëŠ” ë„ì…ë¶€]

**ë³¸ë¬¸**:
[ì†Œì œëª©ì„ í™œìš©í•œ ì²´ê³„ì  êµ¬ì„±, ë©”ì¸í‚¤ì›Œë“œ 5-6íšŒ + ë³´ì¡°í‚¤ì›Œë“œë“¤ 3-4íšŒì”© ìì—°ìŠ¤ëŸ½ê²Œ ë°˜ë³µ]

**ê²°ë¡ **:
[ìš”ì•½ ë° í–‰ë™ ìœ ë„, ëŒ“ê¸€ ì†Œí†µ ìœ ë„ ë¬¸êµ¬ í¬í•¨]

**ì¶”ì²œ íƒœê·¸**: ì´ {avg_tag_count}ê°œ íƒœê·¸ë¥¼ ì‘ì„±í•˜ë˜, #{main_keyword}{"" if not sub_keywords else ", #" + ", #".join([kw.strip() for kw in sub_keywords.split(",") if kw.strip()])} í¬í•¨ í•„ìˆ˜, ë‚˜ë¨¸ì§€ëŠ” ìœ„ ë¶„ì„ëœ ì¸ê¸° íƒœê·¸ ì°¸ê³ í•˜ì—¬ ë¸Œëœë“œëª… ì œì™¸í•˜ê³  ì‘ì„±
```
"""
        return prompt.strip()
    

def create_ai_request_data(main_keyword: str, sub_keywords: str, analyzed_blogs: List[Dict], content_type: str = "ì •ë³´/ê°€ì´ë“œí˜•", tone: str = "ì •ì¤‘í•œ ì¡´ëŒ“ë§ì²´", review_detail: str = "") -> Dict:
    """AI ìš”ì²­ìš© ë°ì´í„° ìƒì„± (ì»¨í…ì¸  ìœ í˜•ê³¼ ë§íˆ¬, í›„ê¸° ì„¸ë¶€ ìœ í˜• í¬í•¨)"""
    try:
        structure_analyzer = BlogContentStructure()
        structured_data = structure_analyzer.analyze_blog_structure(analyzed_blogs)
        structured_data["keyword"] = main_keyword  # ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•´ ë©”ì¸ í‚¤ì›Œë“œ ì €ì¥
        
        # AI í”„ë¡¬í”„íŠ¸ ìƒì„± (ìŠ¤íƒ€ì¼ ì˜µì…˜ í¬í•¨)
        prompt_generator = BlogAIPrompts()
        ai_prompt = prompt_generator.generate_content_analysis_prompt(main_keyword, sub_keywords, structured_data, content_type, tone, review_detail)
        
        return {
            "structured_data": structured_data,
            "ai_prompt": ai_prompt,
            "raw_blogs": analyzed_blogs,
            "main_keyword": main_keyword,
            "sub_keywords": sub_keywords,
            "content_type": content_type,
            "tone": tone,
            "review_detail": review_detail
        }
        
    except Exception as e:
        logger.error(f"AI ìš”ì²­ ë°ì´í„° ìƒì„± ì‹¤íŒ¨: {e}")
        return {}


